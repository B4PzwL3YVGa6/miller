================================================================
BUGFIXES

:D

================================================================
NON-RELEASE:

! rh/fedora/centos
* call for use-cases? (go first.)
* go through lmag article & clarify all unclears
* windows port?
? msort.o wt?

----------------------------------------------------------------
PRE-RELEASE 4.6.0:

! valgrinds
! xxxes

! greatly generalize filter: simply insist it end in a bare boolean ?
  - disallow filter() inside mlr filter; UT that
  - many more UT cases for filter now

----------------------------------------------------------------
UT FOR 4.6.0:

* UT/mlh/mld func @ filter
* disallow filter() inside filter
* insist on final bare boolean; allow others before that (incl. begin/end)
* UT/mlh/mld -e, and mixed -f and -e, for filter/put
* no begin/end/func/subr within subr
* print/printn zary
* no begin/end/func/subr within func
* func no subr call
* func no srec assignment x 3, no oosvar assignment x 2, no filter, no unset
* func no tee, emitfx3; but allow print, dump.
* disallow func/subr redefines
* func/subr exhaustively. local/return/etc in/out of various; for ->func -> while; subr -> func; etc
* with valgrind: func/subr args read, written, both, neither.
* block-locals can shadow for-locals ... yuck. strict-mode opportunity?
* locals in all curly-braced control structures; top-level locals; scope, extent, freeing.
* distinct locals within if/elseif/.../else
* mlr --opprint --from s put -v '$o1 = a; local a=1000+NR; $o2 = a; a=2000+NR; $o3 = a'

----------------------------------------------------------------
DOC FOR 4.6.0:

To file:
* note mlr -l -L -f -F -k -K rather prominently at mlh.
* mlh/mld func @ filter
* absent vs. empty; unset $x vs. $x="". no null keyword.

vars:
* clarify absent-null for variable assignments esp local. xref to homogeneity feature.

covers:
* func-def example @ cover x n
* triple-for example @ cover x n

@ new print/printn section:
* print/printn zary

filter/put w/ -f/-e:
* new mld section

mlh:
* func-def example @ mlr put -h ?
* triple-for example @ mlr put -h ?

func/subr:
* no begin/end/func/subr within func
* (lhs) func no subr call
* (lhs) func no srec assignment x 3, no oosvar assignment x 2, no filter, no unset
* (lhs) func no tee, emitfx3; but allow print, dump.
* disallow func/subr redefines
* locals in all curly-braced control structures; top-level locals; scope, extent, freeing.
* no begin/end/func/subr within subr
* note UDFs may not overwrite built-in functions; subrs have a different namespace (log example); each
  kind may not be multiply defined.
* local @ RHS before @ LHS: absent skips assign
* local a=1 @ outer; a=2 in inner; inner modifies outer. avoid with local a=2 in inner.
* a=2 before local a=1 -- why to even use local (when optional & when necessary).
* cookbook examples

file-formats page:
* --c2p, --c2j etc ...
* --pprint --barred; emph for output only

KW autodoc:
* kw autodoc mods for func/subr/call/return; also add NR PI E etc. to keyword help.

----------------------------------------------------------------
4.6.0 FEATURES:

* func & subr. acknowledge awk yet again.
* triple-fors
* multiple filter/put -f with examples @ new mld section.
* most-frequent/least-frequent
* seqgen
* variadic min & max
* bare print/printn
* --c2p et al.
* --pprint --barred
* mlr -F and -K. Note -l -L -f -F -k -K.

* inverse-transform-sampling example at cookbook.
* 10-min

* final xxx check
* final valgrind check

----------------------------------------------------------------
4.7.0 ideas:

! more than 'syntax error' from lemon-parse failures ... lemon API research

! multi-field x many verbs

! -f/-r field-name-spec opportunities throughout
  - bar
  - count-distinct
  - histogram
  - label
  - merge-fields -x
  - nest
  - reorder
  - sec2gmt/seg2gmtdate
  - sort
  * stats1
  * stats2
  - step
  - top
  ? join
  ? decimate -g
  ? head -g
  ? sample -g
  ? tail -g
  - uniq -g

* emph override wording: from rel notes.
  "Likewise --ofs, --ors, --ops, --jvstack, and all other output-formatting
  options from the main help at mlr -h and/or man mlr default to the main
  command-line options, and may be overridden with flags supplied to mlr put and
  mlr tee."

? disallow reads of unset boundvars ? more generally, runtime checks in some --strict ?
? some help for keyword clashes? e.g. 'func E(x) { ... }' ?
? multiple-valued function returns??

* bargv0 throughout, replacing "mlr" and argv[0] both. (former against name-changes; latter against /usr/bin/mlr.)

? mlr step -a shift --by {n}
? --imd ?

!?! seqgen as lrec-reader ?!?

----------------------------------------------------------------
? double-quote-aware (non-lite) nidx & dkvp options?
? comma-number -- using locale?

? triple-for with boundvars?
? user-defined functions?
? localvars w/ decl syntax?

! multiple -f w/ append so linker is cat
* MLRPATH

----------------------------------------------------------------
? narrative/slides doc ...
? stdin-then-tail-f
? --strict?

* find a more elegant way to do no-semicolon-after-block but don't block 4.1.0
? autodetect format by file extension -- ?
? c-ify the rectangularize feature? unset fields; and?or? emit fields; and?or?
* two remaining valgrinds -- both venial

? substring?
? CONVFMT? IGNORECASE? MLRPATH?

* lrec get followed by put/remove: getext variant returning node for unlink, valpoke, or null == append to avoid
  double-searching.
* 64-bit lengths for containers. test with 5-billion-integer-seq data.

----------------------------------------------------------------
MORE

* look into 'perf'
* linreg in terms of stats only ... check py book
* cat/cut langcomps (w/ gh links) -> perf page

* pipe-viewer-like feature to stderr?

* stats1/stats2 sliding-window feature? and/or with ewma-coefficients (much easier)
  - mean/stddev/var; skew/kurt?
  - linregs; corr/cov?
  ? also, option of weighted stats w/ explicit weights field?
  ? maybe just EWMA with well-known sumw followed by then-chaining. write up the weights if so?

* tbin/ok -> cookbook
* debian screenshot
* ruby @ optextdep @ mld; poki+mkman
* stdin filename keyword for read-from-file-then-tail-f mode (e.g. mlr etc)
  - needs refactor for lrec_reader_alloc callsite
* perf page: (1) redo; (2) note GNU/etc; (3) compare to mawk (http://invisible-island.net/mawk/)
* EOS comments thruout
* valgrind note @ new dev page/section
* join: final sllv_free in destructor (lo-pri)
* anim ref https://github.com/edi9999/path-extractor

----------------------------------------------------------------
NARRATIVE INTRO:
* sql example
* logging example
* csv example
* "what do these have in common?"

----------------------------------------------------------------
COOKBOOK/FAQ/ETC.:

* cookbook:
  - eval stuff from https://github.com/johnkerl/miller/issues/88

    $ mlr --csvlite stats2 -a linreg-pca  -f x,y x
    x_y_pca_m,x_y_pca_b,x_y_pca_n,x_y_pca_quality
    1.030300,0.949250,4,0.999859
    $ mlr --csvlite --odkvp --ofs semicolon stats2 -a linreg-pca  -f x,y x
    x_y_pca_m=1.030300;x_y_pca_b=0.949250;x_y_pca_n=4;x_y_pca_quality=0.999859
    $ eval $(mlr --csvlite --odkvp --ofs semicolon stats2 -a linreg-pca  -f x,y x)
    $ echo $x_y_pca_m
    1.030300

  - hold-and-fit regressor doc: 'then put' for residuals; note avoids two-pass &
    the saving of fit parameters
  - histo w/ min/max is effectively 2-pass (unless you have prior knowledge about the data).
    note count-distinct w/ int() func.
  - two-pass lin/logi reg vs. hold-and-fit.

  - very specific R/mysql/etc inouts

  - polyglottal dkvp/etc production.
  - very specific examples of sed/grep/etc preprocessing to structurize semi-structured data (e.g. logs)

  - checku.dash -> cookbook

* faqents:
  - rsum as proxy for per-record/agg-only mixed output

* other doc besides cookbook & faq:
  - R doc:
    ! xref @ covers x 2
    ! be very clear streaming vs. dataframe -- each has things the other can't do
    ! emph mlr has light stats but for heavyweight analysis use R et al.

* --mmap @ mlr -h

================================================================
* ect feature?
  -> maybe better in cookbook ...
  - in1 optional: t (epoch seconds); default systime()
  - in2: nleft
  - in3 optional: target #/field name
  - in optional: -s flag or not
  - out1: etchours
  - out2: etcstamp

  o expose mapper_stats2_alloc
  o expose mapper_cut_alloc
  o encapsulate the following:
    mlr put '$t=systime()' \
      then filter 'NR>4' \
      then  put '$nleft=$target-$n' \
      then stats2 -s -a linreg-pca -f t,nleft \
      then put '$etc= -$t_n_pca_b/$t_n_pca_m; $etcstamp=sec2gmt($etc); $etchours=($etc-systime())/3600.0'

* mlr step -a from-first -f t \
    then cut -o -f t_from_first,ntodo \
    then step -a ewma -d 0.005,0.01,0.1 -o a,b,c -f ntodo \
    then stats2 -s -a linreg-pca -f \
      t_from_first,ntodo,t_from_first,ntodo_ewma_a,t_from_first,ntodo_ewma_b,t_from_first,ntodo_ewma_c \
    then put '
      $ect0 = -$t_from_first_ntodo_pca_b/$t_from_first_ntodo_pca_m;
      $ecta = -$t_from_first_ntodo_ewma_a_pca_b/$t_from_first_ntodo_ewma_a_pca_m;
      $ectb = -$t_from_first_ntodo_ewma_b_pca_b/$t_from_first_ntodo_ewma_b_pca_m;
      $ectc = -$t_from_first_ntodo_ewma_c_pca_b/$t_from_first_ntodo_ewma_c_pca_m
    ' \
    then cut -o -f t_from_first,ect0,ecta,ectb,ectc

----------------------------------------------------------------
* introduce a fourth, padding separator for all formats? (for leading/trailing strip/skip.)
  o allows 'x = 10' in DKVP
  o allows right-justified keys in XTAB

* hold-and-emit fraction?

* statsn covar, ols, logistic: port material from my stats_m/sackmat_m for much of that

* uni/multivariate logistic for ternary & above?

? wiki quickselect ?

* hash-collision ifdef instrumentation -> maybe find a better hash function out there
* lemon in-dir -- cf wiz note
* gprof link with -lc on FreeBSD -- ?

================================================================
UT/REG
* ut cat/X/cat for all X
* ut tac/X/cat for all X
* ut cat/X/tac for all X
* ut tac/X/tac for all X
* ut multi-csv I/O: include --icsvlite --odkvp and --idkvp --ocsv, as well as --csv cases
* ut het-xtab out
* ut modulus operator
* ut make should-fail machinery & use it for null-key dkvp cases.
* ut all mathlib funcs
* ut int/float/string
* ut roundm
* ut join with left/right-prefix

================================================================
DOC

* Note that PCA is better than OLS for roundoff error (sum of squares ...):
  grep red data/multicountdown.txt | head -n 13 | mlr --opprint stats2 -a linreg-ols -f t,count
  grep red data/multicountdown.txt | head -n 14 | mlr --opprint stats2 -a linreg-ols -f t,count

================================================================
IMPROVEMENTS

* run go/d/etc on sprax & include #'s in perf pg, and/or rm xref in the latter & just post xlang perf #'s there
* link to gh/jk/m xlang impls ... and/or cardify their sources :) ... or maybe just link to gh/jk/m xlang dir
* ack c impl has been repeatedly optimized but even the original version (also cutc.c ...) outperforms

* update t1.rb including numeric sort; fix appropriateness of -t=

* more use of restrict pointers ... ?

================================================================
PYTHON
* pgr + stats_m same I/O modules??

================================================================
FYI

Semantic versioning:
Given a version number MAJOR.MINOR.PATCH, increment the:

* MAJOR version when you make incompatible API changes,
* MINOR version when you add functionality in a backwards-compatible manner, and
* PATCH version when you make backwards-compatible bug fixes.

Initial release: https://news.ycombinator.com/item?id=10066742
v2.0.0  release: https://news.ycombinator.com/item?id=10132831

HN FEEDBACKS 2015-08-15 (https://news.ycombinator.com/item?id=10066742).
look-ats:
* cq?
* https://github.com/harelba/q
* https://github.com/google/crush-tools
* https://github.com/BurntSushi/xsv
* https://github.com/pydata/pandas/blob/master/pandas/io/tests/test_parsers.py
* https://drill.apache.org
* https://github.com/dbro/csvquote

https://help.github.com/articles/github-flavored-markdown/

shell: mlr put '$z=$x+$y'
lldb:  run put "\$z=\$x+\$y"

http://include-what-you-use.org/

----------------------------------------------------------------
https://fedoraproject.org/wiki/How_to_create_an_RPM_package
https://wiki.centos.org/HowTos/Packages/ContributeYourRPMs
https://lists.centos.org/pipermail/centos/2012-September/129227.html
https://fedoraproject.org/wiki/Join_the_package_collection_maintainers
https://fedoraproject.org/wiki/How_to_get_sponsored_into_the_packager_group
https://fedoraproject.org/wiki/Package_Review_Process
https://docs.fedoraproject.org/ro/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch11s03.html
http://wiki.networksecuritytoolkit.org/nstwiki/index.php/HowTo_Create_A_Patch_File_For_A_RPM

================================================================
git remote add upstream https://github.com/Homebrew/homebrew
git fetch upstream
git rebase upstream/master
git checkout -b miller-3.4.0
shasum -a 256 ../mlr-3.4.0.tar.gz
edit Library/Formula/miller.rb
git add ...
git commit -m 'miller 3.4.0'
git push -u origin miller-3.4.0
submit the pull request

----------------------------------------------------------------
Squash commits by:
  brew update
  git checkout $YOUR_BRANCH
  git rebase --interactive origin/master
  mark each commit other than the first as "squash" or "fixup"
  git push -f

http://codeinthehole.com/writing/pull-requests-and-other-good-practices-for-teams-using-github/
